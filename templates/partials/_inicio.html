{% load static %}
<section id="inicio" class="text-center my-2 position-relative overflow-hidden">
    <!-- Fondo dinÃ¡mico -->
    <div id="banner-bg"></div>

    <img src="{% static 'img/ESSA-logo.png' %}" alt="ESSA Logo" class="mb-3" style="max-width:150px; position:relative; z-index:1;">

    {% if user.is_authenticated %}
        <h2 class="text-blue-dark position-relative" style="z-index:1;">Hola {{ user.get_public_name }}</h2>
        <p class="lead position-relative" style="z-index:1;">Bienvenido a ServiTracker. Accede a tu panel para gestionar tus reportes y datos.</p>

        <div class="d-flex justify-content-center gap-3 mt-3 position-relative" style="z-index:1;">
            {% if user.rol == "administrador" %}
                <a href="{% url 'dashboard_admin' %}" class="btn btn-blue-mid">ğŸ”§ Ir al Dashboard</a>
            {% elif user.rol == "agente" %}
                <a href="{% url 'dashboard_agente' %}" class="btn btn-blue-mid">ğŸ“Š Panel de Agente</a>
            {% elif user.rol == "ciudadano" %}
                <a href="{% url 'dashboard_ciudadano' %}" class="btn btn-blue-mid">ğŸ  Mi Panel</a>
            {% elif user.rol == "tecnico" %}
                <a href="{% url 'dashboard_tecnico' %}" class="btn btn-blue-mid">ğŸ” Mis asignaciones</a>
            {% else %}
                <a href="{% url 'perfil' %}" class="btn btn-blue-mid">ğŸ‘¤ Mi perfil</a>
            {% endif %}
            <a href="{% url 'logout' %}" class="btn btn-secondary">Cerrar sesiÃ³n</a>
        </div>

        <!-- Resumen rÃ¡pido -->
        <div class="row mt-5">
            <div class="col-md-8 offset-md-2">
                <div class="card shadow-sm">
                    <div class="card-header bg-blue-mid text-white">
                        <h5 class="mb-0">ğŸ“„ Resumen rÃ¡pido</h5>
                    </div>
                    <div class="card-body">
                        {% if user.rol == "ciudadano" %}
                            {% if pqr_list %}
                                <ul class="list-group">
                                    {% for reporte in pqr_list %}
                                        <li class="list-group-item">
                                            <strong>ID:</strong> {{ reporte.id }} â€” {{ reporte.descripcion }}
                                            <span class="badge bg-info">{{ reporte.estado.nombre }}</span>
                                        </li>
                                    {% endfor %}
                                </ul>
                                <div class="mt-3 text-center">
                                    <a href="{% url 'mi_lista_pqr' %}" class="btn btn-blue-mid">Ver todas mis PQR</a>
                                </div>
                            {% else %}
                                <p>No has creado PQR aÃºn.</p>
                            {% endif %}
                        {% elif user.rol == "tecnico" %}
                            {% if asignaciones %}
                                <ul class="list-group">
                                    {% for reporte in asignaciones %}
                                        <li class="list-group-item">
                                            <strong>ID:</strong> {{ reporte.id }} â€” {{ reporte.descripcion }}
                                            <span class="badge bg-info">{{ reporte.estado.nombre }}</span>
                                        </li>
                                    {% endfor %}
                                </ul>
                                <div class="mt-3 text-center">
                                    <a href="{% url 'mis_asignaciones' %}" class="btn btn-blue-mid">Ver todas mis asignaciones</a>
                                </div>
                            {% else %}
                                <p>No tienes PQR asignadas.</p>
                            {% endif %}
                        {% elif user.rol == "agente" or user.rol == "administrador" %}
                            <p><strong>Pendientes:</strong> {{ pendientes }} | 
                               <strong>En curso:</strong> {{ en_curso }} | 
                               <strong>Resueltos:</strong> {{ resueltos }}</p>

                            {% if user.rol == "administrador" %}
                                <h6 class="mt-4">ğŸ•µï¸ Ãšltimos 5 PQR registrados</h6>
                                {% if ultimos_pqr %}
                                    <ul class="list-group">
                                        {% for reporte in ultimos_pqr %}
                                            <li class="list-group-item text-start">
                                                <strong>ID:</strong> {{ reporte.id }} |
                                                <strong>Ciudadano:</strong> {{ reporte.ciudadano.get_full_name }} |
                                                <strong>Falla:</strong> {{ reporte.tipo_falla }} |
                                                <strong>Estado:</strong> {{ reporte.estado.nombre }}
                                            </li>
                                        {% endfor %}
                                    </ul>
                                {% else %}
                                    <p>No hay PQR registrados aÃºn.</p>
                                {% endif %}
                            {% endif %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    {% else %}
        <h2 class="text-blue-dark position-relative" style="z-index:1;">Bienvenido a ServiTracker</h2>
        <p class="lead position-relative" style="z-index:1;">Reporta fallas en el servicio elÃ©ctrico de forma rÃ¡pida y sencilla.</p>
        <div class="d-flex justify-content-center gap-3 mt-3 position-relative" style="z-index:1;">
            <a href="{% url 'login' %}" class="btn btn-blue-mid">ğŸ” Iniciar sesiÃ³n</a>
            <a href="{% url 'nuevo_pqr' %}" class="btn btn-orange-dark">âš¡ PQR rÃ¡pida</a>
        </div>
    {% endif %}
</section>
