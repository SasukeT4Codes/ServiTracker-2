{% extends 'base.html' %}
{% load static %}

{% block title %}Inicio | ServiTracker{% endblock %}

{% block content %}
<section id="inicio" class="text-center my-2 position-relative overflow-hidden">
    <!-- Fondo dinÃ¡mico -->
    <div id="banner-bg"></div>

    <img src="{% static 'img/ESSA-logo.png' %}" alt="ESSA Logo" class="mb-3" style="max-width:150px; position:relative; z-index:1;">

    {% if user.is_authenticated %}
        <h2 class="text-blue-dark position-relative" style="z-index:1;">Hola {{ user.get_public_name }}</h2>
        <p class="lead position-relative" style="z-index:1;">Bienvenido a ServiTracker. Accede a tu panel para gestionar tus reportes y datos.</p>

        <div class="d-flex justify-content-center gap-3 mt-3 position-relative" style="z-index:1;">
            {% if user.rol == "administrador" %}
                <a href="{% url 'dashboard_admin' %}" class="btn btn-blue-mid">ğŸ”§ Ir al Dashboard</a>
            {% elif user.rol == "agente" %}
                <a href="{% url 'dashboard_agente' %}" class="btn btn-blue-mid">ğŸ“Š Panel de Agente</a>
            {% elif user.rol == "ciudadano" %}
                <a href="{% url 'dashboard_ciudadano' %}" class="btn btn-blue-mid">ğŸ  Mi Panel</a>
            {% elif user.rol == "tecnico" %}
                <a href="{% url 'dashboard_tecnico' %}" class="btn btn-blue-mid">ğŸ” Mis asignaciones</a>
            {% else %}
                <a href="{% url 'perfil' %}" class="btn btn-blue-mid">ğŸ‘¤ Mi perfil</a>
            {% endif %}
            <a href="{% url 'logout' %}" class="btn btn-secondary">Cerrar sesiÃ³n</a>
        </div>

        <!-- Resumen rÃ¡pido de PQR -->
        <div class="row mt-5">
            <div class="col-md-6 offset-md-3">
                <div class="card shadow-sm">
                    <div class="card-header bg-blue-mid text-white">
                        <h5 class="mb-0">ğŸ“„ Resumen rÃ¡pido de tus PQR</h5>
                    </div>
                    <div class="card-body">
                        {% if user.rol == "ciudadano" %}
                            {% with pqr_list=PQR.objects.filter(ciudadano=user) %}
                                {% if pqr_list %}
                                    <ul class="list-group">
                                        {% for reporte in pqr_list|slice:":5" %}
                                            <li class="list-group-item">
                                                <strong>ID:</strong> {{ reporte.id }} â€” {{ reporte.descripcion }}
                                                <span class="badge 
                                                    {% if reporte.estado.nombre == 'Pendiente' %} bg-warning
                                                    {% elif reporte.estado.nombre == 'En curso' %} bg-info
                                                    {% elif reporte.estado.nombre == 'Resuelto' %} bg-success
                                                    {% elif reporte.estado.nombre == 'Urgente' %} bg-danger
                                                    {% elif reporte.estado.nombre == 'Muy urgente' %} bg-dark
                                                    {% else %} bg-secondary
                                                    {% endif %}">
                                                    {{ reporte.estado.nombre }}
                                                </span>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                    <div class="mt-3 text-center">
                                        <a href="{% url 'mi_lista_pqr' %}" class="btn btn-blue-mid">Ver todas mis PQR</a>
                                    </div>
                                {% else %}
                                    <p>No has creado PQR aÃºn.</p>
                                {% endif %}
                            {% endwith %}
                        {% else %}
                            <p>Accede a tu dashboard para ver tus reportes.</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    {% else %}
        <h2 class="text-blue-dark position-relative" style="z-index:1;">Bienvenido a ServiTracker</h2>
        <p class="lead position-relative" style="z-index:1;">Reporta fallas en el servicio elÃ©ctrico de forma rÃ¡pida y sencilla.</p>
        <div class="d-flex justify-content-center gap-3 mt-3 position-relative" style="z-index:1;">
            <a href="{% url 'login' %}" class="btn btn-blue-mid">ğŸ” Iniciar sesiÃ³n</a>
            <a href="{% url 'nuevo_pqr' %}" class="btn btn-orange-dark">âš¡ PQR rÃ¡pida</a>
        </div>
    {% endif %}
</section>

<hr>

<!-- Secciones informativas -->
<section id="nosotros" class="my-5">
    <h3 class="text-blue-mid">Â¿QuiÃ©nes somos?</h3>
    <p>
        ServiTracker se integra con la Electrificadora de Santander (ESSA), empresa del Grupo EPM que trabaja dÃ­a a dÃ­a por la construcciÃ³n de territorios sostenibles y competitivos en la regiÃ³n. 
    </p>
    <p>
        Nuestra misiÃ³n es mejorar la comunicaciÃ³n entre ciudadanos y empresas de servicios pÃºblicos, facilitando el reporte y seguimiento de fallas, y apoyando la gestiÃ³n de proyectos de energÃ­a limpia como la generaciÃ³n solar y la movilidad elÃ©ctrica.
    </p>
</section>

<section id="servicios" class="my-5">
    <h3 class="text-blue-mid text-center mb-4">Servicios</h3>
    <div class="row text-center">
        <div class="col-md-4 mb-3">
            <div class="card h-100 shadow-sm">
                <img src="{% static 'img/atencion.png' %}" class="card-img-top" alt="AtenciÃ³n">
                <div class="card-body">
                    <h5 class="card-title">AtenciÃ³n al cliente</h5>
                    <p class="card-text">Canales de atenciÃ³n: oficinas, chat virtual, WhatsApp empresarial y asesorÃ­a en lÃ­nea.</p>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card h-100 shadow-sm">
                <img src="{% static 'img/empresas.png' %}" class="card-img-top" alt="Empresas">
                <div class="card-body">
                    <h5 class="card-title">Empresas y comunidad</h5>
                    <p class="card-text">Soluciones energÃ©ticas integrales, programas sociales y proyectos de innovaciÃ³n.</p>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card h-100 shadow-sm">
                <img src="{% static 'img/energia.png' %}" class="card-img-top" alt="EnergÃ­a">
                <div class="card-body">
                    <h5 class="card-title">EnergÃ­a y sostenibilidad</h5>
                    <p class="card-text">PromociÃ³n del consumo responsable, generaciÃ³n solar y modernizaciÃ³n de la red.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="extras" class="my-5 bg-blue-light p-4 rounded shadow-sm">
    <h3 class="text-blue-dark text-center mb-3">ğŸŒŸ Â¿Por quÃ© elegir ServiTracker?</h3>
    <div class="row text-center">
        <div class="col-md-4">
            <h5 class="text-orange-dark">Rapidez</h5>
            <p>Reporta fallas en segundos y recibe seguimiento inmediato.</p>
        </div>
        <div class="col-md-4">
            <h5 class="text-orange-dark">Transparencia</h5>
            <p>Consulta el estado de tus PQR en tiempo real.</p>
        </div>
        <div class="col-md-4">
            <h5 class="text-orange-dark">Confiabilidad</h5>
            <p>Respaldado por ESSA y el Grupo EPM.</p>
        </div>
    </div>
</section>

<section id="contacto" class="my-5">
    <h3 class="text-blue-mid">Contacto</h3>
    <p>Â¿Tienes dudas o sugerencias? EscrÃ­benos a <strong>essa@essa.com.co</strong> o utiliza nuestros canales de atenciÃ³n:</p>
    <ul>
        <li>LÃ­nea gratuita: <strong>01 8000 971 903</strong></li>
        <li>WhatsApp: <strong>318 833 91 21</strong></li>
        <li>Emergencias: <strong>115</strong></li>
        <li>Sede: Carrera 19 No. 24-56, Bucaramanga</li>
    </ul>
</section>

<!-- JS dinÃ¡mico -->
<script src="{% static 'js/index.js' %}"></script>
{% endblock %}
